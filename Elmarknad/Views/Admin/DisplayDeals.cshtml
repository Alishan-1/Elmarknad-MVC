@model Elmarknad.Models.ViewModels.DisplayDealsViewModel
@{
    ViewBag.Title = "Visar avtal";
    Layout = "~/Views/Admin/_LayoutAdmin.cshtml";
}

<h2>Alla avtal</h2>
<div class="col-lg-12">
    <table class="table table-dark">
       

       
        

            @foreach (var item in Model.Deals)
            {
        <tbody style="border: 2px solid #000; margin-top: 2%; margin-bottom: 2%;">
            <tr>
                <th scope="col">Pris</th>
                <th scope="col">Kontrakt</th>
                <th scope="col">Elförbrukning</th>
                <th scope="col">Typ</th>
                <th scope="col">Extra info</th>
                <th scope="col">Kundbetyg</th>
                <th scope="col">Årlig avgift</th>
                <th scope="col">Engångsavgift</th>
                <th scope="col">Fastpris</th>
                <th scope="col">RörligtInköpsPris</th>
            </tr>
            <tr>
                <td>
                    @if (item.Price != null)
                    {@item.Price}
                </td>
                <td>
                    @if (item.Contract != null)
                    {@item.Contract}
                </td>
                <td>
                    @item.Förbrukning
                </td>
                <td>
                    @if (item.Typ != null)
                    {@item.Typ}
                </td>
                <td>
                    @if (item.ExtraInfo != null)
                    {@item.ExtraInfo}
                </td>
                <td>
                    @item.Rating
                </td>
                <td>
                    @if (item.ÅrsAvgift != null)
                    {@item.ÅrsAvgift}
                </td>
                <td>
                    @if (item.Engångsavgift != null)
                    {@item.Engångsavgift}
                </td>
                <td>
                    @if (item.Fastpris != null)
                    {@item.Fastpris}
                </td>
                <td>
                    @if (item.RörligtInköpsPris != null)
                    {@item.RörligtInköpsPris}
                </td>
            </tr>
            <tr>
                <th scope="col">RörligtPåslag</th>
                <th scope="col">Miljöpåslag</th>
                <th scope="col">Rabatt</th>
                <th scope="col">Moms</th>
                <th scope="col">Uppsägningstid</th>
                <th scope="col">Automatiskförlängning</th>
                <th scope="col">Omteckningsrätt</th>
                <th scope="col">Elområde</th>
                <th scope="col">Elbolag</th>
                <th scope="col">Radera</th>
            </tr>
            <tr>
                <td>
                    @if (item.RörligtPåslag != null)
                    {@item.RörligtPåslag}
                </td>
                <td>
                    @if (item.Miljöpåslag != null)
                    {@item.Miljöpåslag}
                </td>
                <td>
                    @if (item.Rabatt != null)
                    {@item.Rabatt}
                </td>
                <td>
                    @if (item.Moms != null)
                    {@item.Moms}
                </td>
                <td>
                    @if (item.Uppsägningstid != null)
                    {@item.Uppsägningstid}
                </td>
                <td>
                    @if (item.Automatiskförlängning != null)
                    {@item.Automatiskförlängning}
                </td>
                <td>
                    @if (item.Omteckningsrätt != null)
                    {@item.Omteckningsrätt}
                </td>
                <td>
                    @if (item.Elområde.Area != null)
                    {@item.Elområde.Area}
                </td>
                <td>
                    @if (item.ElBolag.Name != null)
                    {@item.ElBolag.Name}
                </td>
                <td class="col-md-2"><btn class="btn btn-danger delete-post" id="@item.ClientId">Ta Bort</btn></td>
            </tr>
        </tbody>

            }

        
    </table>

</div>

@section scripts{
    <script>
        $(".delete-post").on("click", function (e) {
            var id = e.target.getAttribute("id");

            $.ajax({
                url: "/api/company/deleteclient",
                type: "Post",
                data: JSON.stringify([id]),
                contentType: "application/json; charset=utf-8",
                success: function () {

                    alert("Avtalet har tagits bort från databasen.");
                    location.reload();
                },
                error: function () {
                    alert("Något har gått fel. Kontakta admin!")
                }
            })
        });
    </script>
}